<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG to PDF</title>
</head>
<body>
    <h1>SVGの上にテキストを追加しPDFを作成</h1>

    <svg id="svgCanvas" width="500" height="300" xmlns="http://www.w3.org/2000/svg">
        <rect x="0" y="0" width="500" height="300" fill="lightgray"></rect>
        <text x="50" y="50" font-size="20" fill="black" id="svgText">初期テキスト</text>
    </svg>

    <input type="text" id="textInput" placeholder="テキストを入力">
    <button onclick="updateSVG()">SVGに追加</button>
    <button onclick="exportPDF()">PDFをダウンロード</button>

    <script src="script.js" defer></script>

	
	<script>
		import { jsPDF } from "https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js";

function updateSVG() {
    const textInput = document.getElementById("textInput").value;
    const svgText = document.getElementById("svgText");
    svgText.textContent = textInput;
}

function exportPDF() {
    const svgElement = document.getElementById("svgCanvas");
    const serializer = new XMLSerializer();
    const svgString = serializer.serializeToString(svgElement);
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    const img = new Image();
    const svgBlob = new Blob([svgString], { type: "image/svg+xml;charset=utf-8" });
    const url = URL.createObjectURL(svgBlob);

    img.onload = function () {
        canvas.width = svgElement.clientWidth;
        canvas.height = svgElement.clientHeight;
        ctx.drawImage(img, 0, 0);

        const pdf = new jsPDF();
        const imgData = canvas.toDataURL("image/png");
        pdf.addImage(imgData, "PNG", 10, 10, canvas.width / 5, canvas.height / 5);
        pdf.save("output.pdf");
        URL.revokeObjectURL(url);
    };

    img.src = url;
}

window.updateSVG = updateSVG;
window.exportPDF = exportPDF;
		</script>


</body>
</html>